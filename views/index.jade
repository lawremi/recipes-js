html(lang="en")
  head
    meta(charset="utf-8")
    meta(http-equiv="X-UA-Compatible" content="IE=edge")
    meta(name="viewport" content="width=device-width, initial-scale=1")
    title Recipes-JS [beyond reality mod pack]
    link(rel='stylesheet', href='https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css')
    style(type='text/css')
      | .part { font-weight: bold }
      | .qty { font-weight: bold }
      | .comment > span { font-weight: bold }
      | li
    link(rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css")
    link(rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css")
    link(rel="stylesheet" href="/static/index.css")
  body
    .container
      h1= "Recipes-JS "
        small= "[beyond reality mod pack]"
      //p.lead test test 123
      form.form-horizontal
        h4 Items to craft
        each x in [1,2,3,4,5,6]
          - var v_name = query['i' + x + 'name'] || ''
          - var v_qty = query['i' + x + 'qty'] || ''
          .form-group
            .col-xs-9.col-md-5.col-md-offset-3
              input.itembox.form-control(type="text", name="i#{x}name", value="#{v_name}" placeholder="lv bending machine" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false")
            .col-xs-3.col-md-1
              input.form-control(type="text", name="i#{x}qty", value="#{v_qty}", placeholder="1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false")
        .panel-group
          .panel.panel-default
            #techlevelCollapseHeading.panel-heading(role="button" data-toggle="collapse" href="#techlevelCollapse" aria-expanded="false" aria-controls="tecehlevelCollapse")
              h4.panel-title Tech Options
            #techlevelCollapse.collapse.panel-collapse(role="tabpanel" aria-labelledby="techlevelCollapseHeading")
              .panel-body
                each tval, tkey in basictech
                  - var user_tech_level = (tkey in query) ? (Number(query[tkey])) : (tval) ;
                  .form-group
                    label.col-md-4.col-xs-8.col-md-offset-3(for="techselect#{tkey}")= tkey
                    .col-md-2.col-xs-4
                      select.form-control.btn-sm(id="techselect#{tkey}" name="#{tkey}")
                        each lval, lkey in techlevel
                          if lval === user_tech_level
                            option(value="#{lval}" selected="selected")= lkey
                            //input(type="radio", name="#{tkey}", value="#{lval}", checked)
                          else
                            //input(type="radio", name="#{tkey}", value="#{lval}")
                            option(value="#{lval}")= lkey
        input(type="submit")
      if crafts
        hr
        // This page contains the results of a crafting request
        h4 Starting Ingredients
        table.table
          thead
            tr
              th
                .col-md-1.col-xs-1
                .col-md-5.col-xs-8 Item
                .col-md-1.col-xs-2 Qty
          tbody
            - var ingkeys = Object.keys(final);
            - ingkeys.sort();
            each index in ingkeys
              tr.checkable
                td
                  input.col-md-1.col-xs-1(type="checkbox" id="startinging#{index}")
                  .col-md-5.col-xs-8= index
                  .col-md-1.col-xs-2= Number(final[index])
        h4 Crafting Steps
        table.table
          each val, idx in crafts
            tr.checkable
              td
                input.col-md-1.col-xs-1(type="checkbox" id="craftingstep#{idx}")
                .col-md-10.col-xs-10
                  = "Craft "
                  span.qty= Number(val[0])
                  = " "
                  span.part= val[1]
                  = " using recipe "
                  span.recipe= JSON.stringify(val[2])
                  if val[4]
                    span.comment= " = "
                      span= val[4]
                  if val[3]
                    br.visible-xs
                    span.comment= " [COMMENT: "
                      span= val[3]
                      = "]"
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js')
    script(src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js')
    script
      != "var data = " + JSON.stringify(itemlist) + ";"
      | $(function() { $(".itembox").autocomplete({ source: data, delay: 50 }); });
      | $(function() { $(".checkable").click(function() { $(this).find("input").prop("checked", function(i,val) { return !val; }); }); });
    script(src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js")
